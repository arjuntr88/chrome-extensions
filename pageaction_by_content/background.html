<!DOCTYPE html>
<!--
 * Copyright (c) 2010 The Chromium Authors. All rights reserved.  Use of this
 * source code is governed by a BSD-style license that can be found in the
 * LICENSE file.
-->
<html>
  <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>
    <script>
	var request1;
	var regex1=/Finished: SUCCESS/;
	var cons=/console/;
	var buildFin;
      // Called when a message is passed.  We assume that the content script
      // wants to show the page action.
      function onRequest(request, sender, sendResponse) {
        // Show the page action for the tab that the sender (content script)
        // was on.
        buildFin=request;
		alert(getUrl(sender.tab.url));
		chrome.pageAction.show(sender.tab.id);
		chrome.pageAction.setIcon({path:"B&R.png",tabId:sender.tab.id});
        // Return nothing to let the connection be cleaned up.
	/* 	if (window.webkitNotifications) {
		console.log("Notifications are supported!");
		}
		else {
		console.log("Notifications are not supported for this Browser/OS version yet.");
		} */
		
		if(cons.test(sender.tab.url)){
		//testBuild();
		//ttb();
		//alert(getUrl(sender.tab.url));
		if(request!=true)
		{
		
		console.log("req!=true");
		//testBuild();
		
		
		}
		if(request==true)
		{
		console.log("req==true");
		var notification = webkitNotifications.createNotification('B&R.png', 'success','Build Successfull');
		notification.show();
		}
		

		
		}
        sendResponse({});
      };
/* 	  function sleep(milliseconds) {
  var start = new Date().getTime();
  for (var i = 0; i < 1e15; i++) {
    if ((new Date().getTime() - start) > milliseconds){
      break;
    }
  }
} */
	

		 function testBuild()
		{
		
		chrome.tabs.executeScript(null, {file: 'content_script.js'});
		} 
		
 function getUrl(Url)
 {
 
 var pos=Url.lastIndexOf("console");
 
 if(pos==-1)
 return ""
 else
 return Url.slice(0,pos);
 
 }

//ttb();
      // Listen for the content script to send a message to the background page.
      chrome.extension.onRequest.addListener(onRequest);
    </script>
  </head>
</html>
